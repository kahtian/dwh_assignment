DROP TABLE Orders CASCADE CONSTRAINTS;
DROP TABLE Member CASCADE CONSTRAINTS;
DROP TABLE Staff CASCADE CONSTRAINTS;
DROP TABLE Supplier CASCADE CONSTRAINTS;
DROP TABLE Fine CASCADE CONSTRAINTS;
DROP TABLE Reservation_Details CASCADE CONSTRAINTS;
DROP TABLE Order_Details CASCADE CONSTRAINTS;
DROP TABLE Loan_Details CASCADE CONSTRAINTS;
DROP TABLE Reservation CASCADE CONSTRAINTS;
DROP TABLE Purchase CASCADE CONSTRAINTS;
DROP TABLE Loan CASCADE CONSTRAINTS;
DROP TABLE Book_Copy CASCADE CONSTRAINTS;
DROP TABLE Book CASCADE CONSTRAINTS;
 

@"C:\Users\User\OneDrive\Documents\RDS\Y2S3\DWT\dwh_assignment\DW assignment\member.txt"
@"C:\Users\User\OneDrive\Documents\RDS\Y2S3\DWT\dwh_assignment\DW assignment\staff.txt"
@"C:\Users\User\OneDrive\Documents\RDS\Y2S3\DWT\dwh_assignment\DW assignment\supplier.txt"
@"C:\Users\User\OneDrive\Documents\RDS\Y2S3\DWT\dwh_assignment\DW assignment\book.txt"
@"C:\Users\User\OneDrive\Documents\RDS\Y2S3\DWT\dwh_assignment\DW assignment\book_copy.txt"
@"C:\Users\User\OneDrive\Documents\RDS\Y2S3\DWT\dwh_assignment\DW assignment\loan.txt"
@"C:\Users\User\OneDrive\Documents\RDS\Y2S3\DWT\dwh_assignment\DW assignment\loan_details.txt"
@"C:\Users\User\OneDrive\Documents\RDS\Y2S3\DWT\dwh_assignment\DW assignment\fine.txt"
@"C:\Users\User\OneDrive\Documents\RDS\Y2S3\DWT\dwh_assignment\DW assignment\order.txt"
@"C:\Users\User\OneDrive\Documents\RDS\Y2S3\DWT\dwh_assignment\DW assignment\order_details.txt"
@"C:\Users\User\OneDrive\Documents\RDS\Y2S3\DWT\dwh_assignment\DW assignment\purchase.txt"
@"C:\Users\User\OneDrive\Documents\RDS\Y2S3\DWT\dwh_assignment\DW assignment\reservation.txt"
@"C:\Users\User\OneDrive\Documents\RDS\Y2S3\DWT\dwh_assignment\DW assignment\reservation_details.txt"

@"C:\Users\User\OneDrive\Documents\RDS\Y2S3\DWT\dwh_assignment\DW assignment\BOOK_DIM.txt"
@"C:\Users\User\OneDrive\Documents\RDS\Y2S3\DWT\dwh_assignment\DW assignment\DATE_DIM.txt"
@"C:\Users\User\OneDrive\Documents\RDS\Y2S3\DWT\dwh_assignment\DW assignment\MEMBER_DIM.txt"
@"C:\Users\User\OneDrive\Documents\RDS\Y2S3\DWT\dwh_assignment\DW assignment\STAFF_DIM.txt"
@"C:\Users\User\OneDrive\Documents\RDS\Y2S3\DWT\dwh_assignment\DW assignment\SUPPLIER_DIM.txt"
@"C:\Users\User\OneDrive\Documents\RDS\Y2S3\DWT\dwh_assignment\DW assignment\PURCHASE_FACT.txt"
@"C:\Users\User\OneDrive\Documents\RDS\Y2S3\DWT\dwh_assignment\DW assignment\LOAN_FACT.txt"
@"C:\Users\User\OneDrive\Documents\RDS\Y2S3\DWT\dwh_assignment\DW assignment\RESERVATION_FACT.txt"
@"C:\Users\User\OneDrive\Documents\RDS\Y2S3\DWT\dwh_assignment\DW assignment\SALES_FACT.txt"

-- =============================================
-- LOAD DATA GENERATION PROCEDURES
-- =============================================
@"C:\Users\User\OneDrive\Documents\RDS\Y2S3\DWT\dwh_assignment\DW assignment\DATA_GENERATION.sql"

-- =============================================
-- EXECUTE ETL PROCEDURES FOR INITIAL LOAD
-- =============================================
EXEC LOAD_DATE_DIM_INITIAL;
EXEC LOAD_BOOK_DIM_INITIAL;
EXEC LOAD_MEMBER_DIM_INITIAL;
EXEC LOAD_STAFF_DIM_INITIAL;
EXEC LOAD_SUPPLIER_DIM_INITIAL;
EXEC LOAD_PURCHASE_FACT_INITIAL;
EXEC LOAD_SALES_FACT_INITIAL;
EXEC LOAD_LOAN_FACT_INITIAL;
EXEC LOAD_RESERVATION_FACT_INITIAL;

-- =============================================
-- GENERATE 100K+ RECORDS FOR EACH FACT TABLE
-- =============================================
EXEC GENERATE_ALL_FACT_DATA;





